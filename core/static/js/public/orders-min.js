"use strict";class Orders{constructor(e){this.kwargs=e,this.valuesLists={clarityList:["I3","I2","I1","SI2","SI1","VS2","VS1","VVS2","VVS1","IF","FI"],cutList:["N/A","Fair","Good","Very Good","Ideal","Super Ideal","Excellent"],colorList:["M","L","K","J","I","H","G","F","E","D"],shapeList:["Round","Marquise","Asscher","Cushion","Emerald","Heart","Oval","Pear","Princess","Radiant","Another"],symmetryList:["N/A","Good","Very Good","Excellent"],polishList:["N/A","Good","Very Good","Excellent"],fluourList:["None","Faint","Medium","Strong","Very Strong"],labList:["IGI","GIA","GCAl","HDR"],status_list:["Rejected","On verification","Order accepted","Delivery is in progress","Delivered","Completed"],type_list:["COD","Invocie","Cash Memo","Memo","Hold"]},this.request={},this.searchForm=this.getElement(e.search),this.searchBody=this.getElement(e.searchBody),this.searchTriger=this.getElement(e.searchTriger),this.ordersContainer=this.getElement(e.ordersContainer),this.orders={orders:this.getElemetns(e.orders,this.ordersContainer),orderStatus:this.getElemetns(e.orderStatus,this.ordersContainer),orderType:this.getElemetns(e.orderType,this.ordersContainer),orderPlaced:this.getElemetns(e.orderPlaced,this.ordersContainer),orderLen:this.getElemetns(e.orderLen,this.ordersContainer),orderCarat:this.getElemetns(e.orderCarat,this.ordersContainer),orderPrice:this.getElemetns(e.orderPrice,this.ordersContainer),orderNumber:this.getElemetns(e.orderNumber,this.ordersContainer),orderDetails:this.getElemetns(e.orderDetails,this.ordersContainer),orderInvoice:this.getElemetns(e.orderInvoice,this.ordersContainer)},this.modalDetails=this.getElement(e.modalDetails),this.modalDetailsItems={close:this.getElement(e.closeModal,this.modalDetails),type:this.getElement(e.modalType,this.modalDetails),number:this.getElement(e.modalNumber,this.modalDetails),status:this.getElement(e.modalStatus,this.modalDetails),placed:this.getElement(e.modalPlaced,this.modalDetails),len:this.getElement(e.modalLen,this.modalDetails),carat:this.getElement(e.modalCarat,this.modalDetails),price:this.getElement(e.modalPrice,this.modalDetails),content:this.getElement(e.modalContent,this.modalDetails)},this.modalInvoice=this.getElement(e.modalInvoice),this.modalInvoiceItems={close:this.getElement(e.closeModal,this.modalInvoice),buyer:this.getElement(e.modalBuyer,this.modalInvoice),attn:this.getElement(e.modalAttn,this.modalInvoice),address:this.getElement(e.modalAddress,this.modalInvoice),tel:this.getElement(e.modalTel,this.modalInvoice),price:this.getElement(e.modalPrice,this.modalInvoice),content:this.getElement(e.modalContent,this.modalInvoice)},this.key="details"}init(){this.closeModal(this.modalDetailsItems.close,this.modalDetails),this.closeModal(this.modalInvoiceItems.close,this.modalInvoice),this.makeRequest(this.orders.orderDetails,this.modalDetails),this.makeRequest(this.orders.orderInvoice,this.modalInvoice),this.search("search/"),this.searchShow()}debug(e=this){return this}getElement(e,t=document){return t.querySelector(e)}getElemetns(e,t=document){return[...t.querySelectorAll(e)]}closeModal(e,t){e.onclick=()=>{t.classList.remove("active")}}spiner(e="get"){if("get"==e){return'            \n            <div class="text-center text-primary py-4 shadow-sm w-100 bg-lite border-bottom" id="loading-spiner">\n                <div class="spinner-border" role="status">\n                    <span class="visually-hidden">Loading...</span>\n                </div>\n            </div>\n            '}if("remove"==e){const e=this.container.querySelector("#loading-spiner");null!=e&&e.remove()}else if("has"==e){const e=this.container.querySelector("#loading-spiner");return null!=e}}getOrderHTML(e,t,s){let a="text-success";"0"==e.fields.order_status?a="text-danger":"1"==e.fields.order_status&&(a="text-alert");return`\n            <div class="orders__item shadow-sm border" data-orders-item="${e.fields.order_number}">\n            <div class="orders__item-header py-3 px-3">\n                <ul class="orders__item-header-list m-0">\n                    <li class="orders__item-header-element pe-4">\n                        <span class="text-capitalize fs-5 text-primary" data-order-type="${this.valuesLists.type_list[e.fields.order_type]}">${this.valuesLists.type_list[e.fields.order_type]}</span>\n                    </li>\n                    <li class="orders__item-header-element orders__item--date">\n                        <span class="text-uppercase">Order Placed</span>\n                        <span class="orders__item--value" data-order-placed="${t[s]}">${t[s]}</span>\n                    </li>\n                    <li class="orders__item-header-element">\n                        <span class="text-uppercase">Total Diamonds:</span>\n                        <span class="orders__item--value" data-order-diamonds="${e.fields.total_diamonds}">${e.fields.total_diamonds}</span>\n                    </li>\n                    <li class="orders__item-header-element">\n                        <span class="text-uppercase">Total Carat:</span>\n                        <span class="orders__item--value" data-order-carat="${e.fields.total_carat}">${e.fields.total_carat}</span>\n                    </li>\n                    <li class="orders__item-header-element">\n                        <span class="text-uppercase">Total Price:</span>\n                        <span class="orders__item--value">$<span data-order-price="${e.fields.total_price}">${e.fields.total_price}</span></span>\n                    </li>\n                </ul>\n                \n                <div class="orders__item-header-number">\n\n                    <div class="d-flex">\n                        <span class="text-uppercase">Order Number #</span>\n                        <span class="text-capitalize" data-order-number="${e.fields.order_number}">${e.fields.order_number}</span>\n                    </div>\n                    \n                    <div class="d-flex mt-2 orders__header-buttons">\n                        <button type="button" class="link bg-none fs-5 me-3" data-view-details="order_details">View order details</button>\n                        <button type="button" class="link bg-none fs-5" data-view-invoice="view_invoice">View invoice</button>\n                    </div>\n                </div>\n            </div>\n            <div class="orders__item-footer py-3 px-3 border-top">\n                <span class="fs-5 d-block ${a}"> Status: ${this.valuesLists.status_list[e.fields.order_status]}</span>\n            </div>\n        </div>\n        `}makeRequest(e,t,s="details/"){e.map(((e,a)=>{e.onclick=()=>{let e;t==this.modalDetails?(this.key="details",e=this.modalDetailsItems):t==this.modalInvoice&&(this.key="invoice",e=this.modalInvoiceItems);const r=this.orders.orders[a].dataset.ordersItem;t.classList.add("active"),this.request.number=r,e.content.innerHTML="",e.content.insertAdjacentHTML("afterbegin",this.spiner("get")),ajax(s,this.request,this.makeResponce,this)}}))}makeResponce(e,t){const s=JSON.parse(e.diamonds);let a,r;"details"==t.key?(a=t.modalDetails,r=t.modalDetailsItems,r.type.textContent=t.valuesLists.type_list[e.type],r.len.textContent=e.len,r.carat.textContent=e.carat,r.price.textContent=e.price,r.status.textContent=t.valuesLists.status_list[e.status],r.number.textContent=`#${e.number}`,r.placed.textContent=e.placed,"0"==e.status?(r.status.classList.remove("text-success"),r.status.classList.remove("text-alert"),r.status.classList.add("text-danger")):"1"==e.status?(r.status.classList.remove("text-success"),r.status.classList.remove("text-danger"),r.status.classList.add("text-alert")):(r.status.classList.remove("text-danger"),r.status.classList.remove("text-alert"),r.status.classList.add("text-success"))):"invoice"==t.key&&(a=t.modalInvoice,r=t.modalInvoiceItems,r.buyer.textContent=`${e.last_name} ${e.first_name}`,r.attn.textContent=`${e.last_name} ${e.first_name}`,r.address.textContent=e.address,r.tel.textContent=e.tel,r.price.textContent=e.price),r.content.innerHTML="",s.map((e=>{r.content.insertAdjacentHTML("beforeend",getDiamondHTML(e))}))}searchShow(){this.searchTriger.addEventListener("click",(()=>{this.searchBody.classList.toggle("active")}))}search(e="search/"){this.searchForm.addEventListener("submit",(t=>{t.preventDefault();const s=this.getElemetns("input",this.searchForm),a={};if(s.map((e=>{const t=e.name;a[t]=e.value})),a.search.length<10){let e=10-a.search.length;for(let t=0;t<e;t++)a.search+=0}this.ordersContainer.innerHTML="",this.ordersContainer.insertAdjacentHTML("afterbegin",this.spiner("get")),ajax(e,a,this.searchResponce,this)}))}searchResponce(e,t){const s=JSON.parse(e.orders),a=e.date;t.ordersContainer.innerHTML="",s.map(((e,s)=>{t.ordersContainer.insertAdjacentHTML("beforeend",t.getOrderHTML(e,a,s))})),t.orders.orderDetails=t.getElemetns(t.kwargs.orderDetails,t.ordersContainer),t.orders.orderInvoice=t.getElemetns(t.kwargs.orderInvoice,t.ordersContainer),t.makeRequest(t.orders.orderDetails,t.modalDetails),t.makeRequest(t.orders.orderInvoice,t.modalInvoice)}}const orders=new Orders({ordersContainer:"#orders_items",orders:"[data-orders-item]",orderStatus:"[data-order-status]",orderType:"[data-order-type]",orderPlaced:"[data-order-placed]",orderLen:"[data-order-diamonds]",orderCarat:"[data-order-carat]",orderPrice:"[data-order-price]",orderNumber:"[data-order-number]",orderDetails:"[data-view-details]",orderInvoice:"[data-view-invoice]",modalDetails:"#order_details_modal",modalInvoice:"#order_invoice_modal",closeModal:"[data-modal-close]",modalType:"[data-modal-type]",modalStatus:"[data-modal-status]",modalPlaced:"[data-modal-placed]",modalLen:"[data-modal-len]",modalCarat:"[data-modal-carat]",modalPrice:"[data-modal-price]",modalContent:"[data-modal-content]",modalNumber:"[data-modal-number]",modalBuyer:"[data-modal-buyer]",modalAddress:"[data-modal-address]",modalAttn:"[data-modal-attn]",modalTel:"[data-modal-tel]",search:"#orders_search_form",searchBody:"#orders-search-body",searchTriger:"#orders-search-btn"}).debug().init();