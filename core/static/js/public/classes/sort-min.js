"use strict";class SortSystem{constructor(e){this.viewContainer=this.getElement(e.viewContainer),this.simpleContainer=this.getElement(e.simpleContainer),this.simpleItems=this.getElements(e.simpleItems,this.simpleContainer),this.advancedContainer=this.getElement(e.advancedContainer),this.advancedDragBox=this.getElement(e.advancedDragBox,this.advancedContainer),this.advancedOffBox=this.getElement(e.advancedOffBox,this.advancedContainer),this.advancedItems=this.getElements(e.advancedItems,this.advancedContainer),this.plusItems=this.getChilds(e.plusItems,this.advancedItems),this.angleItems=this.getChilds(e.angleItems,this.advancedItems),this.orderBy=["sale_price"],this.url=e.url,this.advancedDataName=e.advancedDataName,this.simpleDataName=e.simpleDataName,this.clarityList=["I3","I2","I1","SI2","SI1","VS2","VS1","VVS2","VVS1","IF","FI"],this.cutList=["N/A","Fair","Good","Very Good","Ideal","Super Ideal","Excellent"],this.colorList=["M","L","K","J","I","H","G","F","E","D"],this.shapeList=["Round","Marquise","Asscher","Cushion","Emerald","Heart","Oval","Pear","Princess","Radiant","Another"],this.symmetryList=["N/A","Good","Very Good","Excellent"],this.polishList=["N/A","Good","Very Good","Excellent"],this.fluourList=["None","Faint","Medium","Strong","Very Strong"],this.labList=["IGI","GIA","GCAl","HDR"],this.extention=e.extention}init(){return this.simpleSort(),this.advancedSort(),this.drag(),this.dragEvent(),this}debug(e=this){return this}getElement(e,t=document){return t.querySelector(e)}getElements(e,t=document){return[...t.querySelectorAll(e)]}getChilds(e,t){const s=[];return t.map((t=>{s.push(t.querySelector(e))})),s}updateValues(e,t="default"){if("default"==t)this.orderBy=this.orderBy.filter((t=>{if(t!==e&&t!==`-${e}`)return t})),this.orderBy.unshift(e);else if("reverse"==t)this.orderBy=this.orderBy.filter((t=>{if(t!==e&&t!==`-${e}`)return t})),this.orderBy.unshift(`-${e}`);else if("remove"==t)this.orderBy=this.orderBy.filter((t=>{if(t!==e&&t!==`-${e}`)return t}));else if("update"==t){if(-1==this.orderBy.indexOf(e)){const t=this.orderBy.indexOf(`-${e}`);this.orderBy[t]=e}else if(-1!=this.orderBy.indexOf(e)){const t=this.orderBy.indexOf(e);this.orderBy[t]=`-${e}`}}else"drag"==t&&(this.orderBy=this.orderBy.filter((t=>{if(t!==e&&t!==`-${e}`)return t})));this.simpleUpdate(),this.advancedUpdate(),this.request()}cleanSimple(){this.simpleItems.map((e=>{e.classList.remove("active-1"),e.classList.remove("active-2")}))}simpleSort(){this.simpleItems.map((e=>{e.onclick=()=>{if(e.classList.contains("active-1")||!e.classList.contains("active-1")&&!e.classList.contains("active-2")){this.cleanSimple(),e.classList.add("active-2");const t=e.dataset.ioSimpleSort;this.updateValues(t,"default")}else if(e.classList.contains("active-2")){this.cleanSimple(),e.classList.add("active-1");const t=e.dataset.ioSimpleSort;this.updateValues(t,"reverse")}}}))}simpleUpdate(){this.cleanSimple(),this.simpleItems.map((e=>{const t=e.dataset.ioSimpleSort;t==this.orderBy[0]?e.classList.add("active-2"):`-${t}`==this.orderBy[0]&&e.classList.add("active-1")}))}advancedPlus(){this.plusItems.map(((e,t)=>{e.onclick=()=>{if(this.advancedItems[t].classList.contains("active-1")||this.advancedItems[t].classList.contains("active-2")){this.advancedItems[t].classList.remove("active-1"),this.advancedItems[t].classList.remove("active-2"),this.advancedOffBox.insertAdjacentElement("afterbegin",this.advancedItems[t]);const e=this.advancedItems[t].dataset.ioAdvancedSort;this.updateValues(e,"remove")}else{this.advancedItems[t].classList.add("active-2"),this.advancedDragBox.insertAdjacentElement("afterbegin",this.advancedItems[t]);const e=this.advancedItems[t].dataset.ioAdvancedSort;this.updateValues(e,"default")}}}))}advancedAngle(){this.angleItems.map(((e,t)=>{e.onclick=()=>{if(this.advancedItems[t].classList.contains("active-1")){this.advancedItems[t].classList.remove("active-1"),this.advancedItems[t].classList.add("active-2");const e=this.advancedItems[t].dataset.ioAdvancedSort;this.updateValues(e,"update")}else if(this.advancedItems[t].classList.contains("active-2")){this.advancedItems[t].classList.remove("active-2"),this.advancedItems[t].classList.add("active-1");const e=this.advancedItems[t].dataset.ioAdvancedSort;this.updateValues(e,"update")}}}))}advancedUpdate(){this.advancedItems.map((e=>{this.advancedOffBox.insertAdjacentElement("afterbegin",e),e.classList.remove("active-1"),e.classList.remove("active-2")})),this.orderBy.map((e=>{this.advancedItems.map((t=>{const s=t.dataset.ioAdvancedSort;e==s?(t.classList.add("active-2"),this.advancedDragBox.insertAdjacentElement("beforeend",t)):e==`-${s}`&&(t.classList.add("active-1"),this.advancedDragBox.insertAdjacentElement("beforeend",t))}))}))}advancedSort(){this.advancedPlus(),this.advancedAngle()}drag(){this.dragObject=new Sortable(this.advancedDragBox,{animation:150,handle:".drag-handle"})}dragEvent(){this.advancedItems.forEach((e=>{e.ondragend=()=>{const e=[];this.getElements("[data-io-advanced-sort]",this.advancedDragBox).map((t=>{if(t.classList.contains("active-1")){const s=`-${t.dataset.ioAdvancedSort}`;e.push(s)}else if(t.classList.contains("active-2")){const s=t.dataset.ioAdvancedSort;e.push(s)}})),this.orderBy=e,this.simpleUpdate()}}))}request(){this.requestData={compare:!1,order:this.orderBy},"compare"==this.orderBy[0]||"-compare"==this.orderBy[0]?(this.requestData.compare=JSON.parse(localStorage.getItem("cart")),this.requestData.order=this.requestData.order.filter((e=>{if("compare"!==e&&"-compare"!==e)return e})),this.requestData.compare=this.requestData.compare.map((e=>e.replace("chb_",""))),this.requestData.compare_order=this.orderBy[0]):(this.orderBy=this.orderBy.filter((e=>"compare"!==e&&"-compare"!==e)),this.requestData.order=this.orderBy),this.viewContainer.innerHTML=this.getSpiner("get"),ajax(this.url,this.requestData,this.responce,this)}responce(e,t){t.getSpiner("has")&&t.getSpiner("remove");JSON.parse(e).map((e=>{t.viewContainer.insertAdjacentHTML("beforeend",getDiamondHTML(e))}));new ElementsControl({manager:".result__item-list",managed:".result__drop-down"}).toggler({single:!0,notThis:".label-result"});if(new ElementsControl({manager:".btn-more--info",managed:".body-more--info"}).toggler({single:!0}),void 0!==t.extention&&null!==t.extention){new ElementsControl({manager:'[data-io-label="diamonds-item"]',managed:".checkbox-results"}).label(t.extention.checked,t.extention.unchecked),t.extention.selected()}}getSpiner(e="get"){if("get"==e){return'            \n            <div class="text-center text-primary py-4 shadow-sm w-100 bg-lite border-bottom border-top my-1" id="loading-spiner">\n                <div class="spinner-border" role="status">\n                    <span class="visually-hidden">Loading...</span>\n                </div>\n            </div>\n            '}if("remove"==e){const e=this.viewContainer.querySelector("#loading-spiner");null!=e&&e.remove()}else if("has"==e){const e=this.viewContainer.querySelector("#loading-spiner");return null!=e}}}